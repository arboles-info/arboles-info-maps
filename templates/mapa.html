{% extends 'base.html' %}
{% load static %}

{% block title %}Mapa de Ã¡rboles y tocones - Visualizador de Ãrboles y Tocones{% endblock %}

{% block content %}
<div class="page-container">
    <div class="controls-container">
        <button class="hamburger-menu" onclick="toggleControls()" id="hamburger-btn">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
        </button>
        
        <div class="controls" id="controls">
        <div class="control-group">
            <label for="bbox">Ãrea (lat,lon,lat,lon):</label>
            <input type="text" id="bbox" placeholder="36.613770852449,-6.410994529724,36.641667904189,-6.328597068787" value="36.613770852449,-6.410994529724,36.641667904189,-6.328597068787">
        </div>
        
        <div class="control-group">
            <label for="limit">LÃ­mite de resultados:</label>
            <input type="number" id="limit" value="500" min="10" max="1000">
        </div>
        
        <div class="control-group">
            <label>
                <input type="checkbox" id="autoUpdate" checked> ActualizaciÃ³n automÃ¡tica
            </label>
        </div>
        
        <div class="control-group">
            <label>
                <input type="checkbox" id="autoFitBounds"> Ajustar vista a datos
            </label>
        </div>
        
        <button class="btn" onclick="loadData()">Cargar Datos</button>
        <button class="btn" onclick="clearMap()">Limpiar Mapa</button>
        <button class="btn" onclick="getUserLocation()">ğŸ“ Mi UbicaciÃ³n</button>
    </div>
</div>

<div class="map-container">
    <!-- EstadÃ­sticas mÃ³viles (solo visibles en mÃ³viles) -->
    <div class="mobile-stats" id="mobile-stats">
        <div class="mobile-stats-summary">
            <span class="mobile-stat-item">ğŸŒ³ <span id="mobile-tree-count">0</span></span>
            <span class="mobile-stat-item">ğŸªµ <span id="mobile-stump-count">0</span></span>
            <span class="mobile-stat-item">ğŸ“Š <span id="mobile-total-count">0</span></span>
        </div>
    </div>
    
    <div id="map"></div>
    
    <div class="loading" id="loading">
        <p>Cargando datos de OpenStreetMap...</p>
    </div>
    
    <div class="stats" id="stats">
        <h3>EstadÃ­sticas</h3>
        <div class="stats-summary">
            <p>Ãrboles: <span id="tree-count">0</span></p>
            <p>Tocones: <span id="stump-count">0</span></p>
            <p>Total: <span id="total-count">0</span></p>
        </div>
        
        <div class="stats-breakdown" id="stats-breakdown">
            <h4>Ãrboles por Especie</h4>
            <div class="species-list" id="species-list">
                <p class="no-data">No hay datos cargados</p>
            </div>
        </div>
    </div>
    
    <div class="legend">
        <h3>Leyenda</h3>
        <div class="legend-item clickable" id="legend-trees" data-layer="trees">
            <div class="legend-color tree-color"></div>
            <span>Ãrboles</span>
            <span class="toggle-indicator">ğŸ‘ï¸</span>
        </div>
        <div class="legend-item clickable" id="legend-stumps" data-layer="stumps">
            <div class="legend-color stump-color"></div>
            <span>Tocones</span>
            <span class="toggle-indicator">ğŸ‘ï¸</span>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- AplicaciÃ³n JavaScript -->
<script src="{% static 'js/app.js' %}"></script>
{% endblock %}


